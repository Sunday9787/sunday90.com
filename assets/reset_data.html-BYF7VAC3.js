import{_ as c,r as p,o as i,c as u,a as s,e as r,d as a,b as t,w as k,f as o}from"./app-DrKNV5QG.js";const d={},v={href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/WeakMap",target:"_blank",rel:"noopener noreferrer"},m={href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol#%E5%85%A8%E5%B1%80%E5%85%B1%E4%BA%AB%E7%9A%84_symbol",target:"_blank",rel:"noopener noreferrer"},b={href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Data_structures",target:"_blank",rel:"noopener noreferrer"},g={href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol#%E5%85%A8%E5%B1%80%E5%85%B1%E4%BA%AB%E7%9A%84_symbol",target:"_blank",rel:"noopener noreferrer"},f={href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Map",target:"_blank",rel:"noopener noreferrer"};function y(w,n){const l=p("RouterLink"),e=p("ExternalLinkIcon");return i(),u("div",null,[n[29]||(n[29]=s("p",null,"æ•°æ®é‡ç½®ï¼Œä½ è‚¯å®šä¸é™Œç”Ÿï¼Œè¿™æœ‰å•¥å¯è®²çš„ï¼Œä¸å°±æ˜¯ å¤åˆ¶ä¸€ä»½ å†é‡æ–°æ›´æ–°ä¸Šå»ï¼Œå“å“~ ä»Šå¤©è®²çš„å¯ä¸æ˜¯è®©ä½ æ‰‹åŠ¨å¤åˆ¶ä¸€ä»½æ‰‹åŠ¨æ›´æ–°",-1)),r(" more "),n[30]||(n[30]=s("h2",{id:"å‰è¨€",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#å‰è¨€","aria-hidden":"true"},"#"),a(" å‰è¨€")],-1)),n[31]||(n[31]=s("p",null,"ç›¸ä¿¡å¤§å®¶éƒ½æœ‰é‡åˆ°è¿™æ ·çš„ä¸€ä¸ªéœ€æ±‚ï¼Œä¾‹å¦‚ form è¡¨å•ï¼Œç‚¹å‡»ç¼–è¾‘åªè¦æ²¡æœ‰ä¿å­˜ï¼Œå–æ¶ˆæ—¶ æ•°æ®åº”è¯¥è¿˜åŸä¸ºä¹‹å‰çš„æ•°æ®",-1)),n[32]||(n[32]=s("p",null,"åœ¨æ­¤ä¹‹å‰ä½ å¯èƒ½ä¼šå…ˆ cloneä¸€ä¸ªæ•°æ®å‰¯æœ¬ï¼Œå–æ¶ˆå†é‡æ–°èµ‹å€¼ä¸Šå»ï¼Œå—¯~ æ²¡é—®é¢˜ ç¡®å®å¯ä»¥",-1)),n[33]||(n[33]=s("p",null,"ä½†æ˜¯å³ä¾¿æ˜¯ä½ æŠŠå®ƒå°è£…æˆä¸€ä¸ªæ–¹æ³•ï¼Œåˆ°æœ€åä¸è¿˜æ˜¯å¾— import æ¥ import è¿‡å»ï¼Œè¿˜è¦å† è°ƒç”¨ã€‚å¥½åƒæœ‰ç‚¹éº»çƒ¦çš„æ ·å­ğŸ‘€",-1)),s("p",null,[n[1]||(n[1]=a("æœ¬æ–‡é€‚åˆç»“åˆä¸Šä¸€ç¯‡æ–‡ç«  ")),t(l,{to:"/log/typescript/design.html"},{default:k(()=>n[0]||(n[0]=[a("æˆ‘æ˜¯è¿™æ ·å†™TSçš„")])),_:1}),n[2]||(n[2]=a(" æ¥é˜…è¯»"))]),n[34]||(n[34]=o(`<h2 id="ä¼ ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#ä¼ ç»Ÿ" aria-hidden="true">#</a> ä¼ ç»Ÿ</h2><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> deepClone <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;lodash&quot;</span>

<span class="token comment">// å‡è®¾ æ•°æ®æ˜¯ä» åç«¯è·å–</span>
<span class="token comment">// useUser.ts</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;è‡³å°Šå®&quot;</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">27</span><span class="token punctuation">,</span>
    lover<span class="token operator">:</span> <span class="token string">&quot;ç´«éœä»™å­&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// user.vue</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  lover<span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// è·å–ç”¨æˆ·</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">useUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// copy</span>
<span class="token keyword">const</span> originData <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

user<span class="token punctuation">.</span>value <span class="token operator">=</span> data

<span class="token comment">// é‡ç½®</span>
<span class="token keyword">function</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  user<span class="token punctuation">.</span>value <span class="token operator">=</span> originData
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¡®å®æ˜¯æ²¡é—®é¢˜ï¼Œç»§ç»­çœ‹ä¸ä¸€æ ·çš„</p><h2 id="ä¸ä¸€æ ·çš„" tabindex="-1"><a class="header-anchor" href="#ä¸ä¸€æ ·çš„" aria-hidden="true">#</a> ä¸ä¸€æ ·çš„</h2><h3 id="æŠ½è±¡ç±»-abstractentity" tabindex="-1"><a class="header-anchor" href="#æŠ½è±¡ç±»-abstractentity" aria-hidden="true">#</a> æŠ½è±¡ç±» AbstractEntity</h3><p>åœ¨æŠ½è±¡ç±»ä¸Šæ·»åŠ  reset æ–¹æ³•</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// abstractEntity.ts</span>
<span class="token keyword">const</span> valueWeakMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap<span class="token operator">&lt;</span>AbstractEntity<span class="token punctuation">,</span> EntityJSON<span class="token operator">&lt;</span>AbstractEntity<span class="token operator">&gt;&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractEntity</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ³¨æ„è¿™é‡Œ</span>
		<span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
    window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      valueWeakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> self<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ³¨æ„è¿™é‡Œ</span>
    <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token function">toRaw</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> valueWeakMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token operator">!</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">as</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">unknown</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>è¿™é‡Œå¯ä»¥æ€è€ƒä¸€ä¸‹ ä¸ºä»€ä¹ˆ è¦ setTimeout å»¶æ—¶ å’Œ reset æ–¹æ³•å†… ä¸ºä½•è¦ toRaw</p></blockquote><h3 id="å®ä½“" tabindex="-1"><a class="header-anchor" href="#å®ä½“" aria-hidden="true">#</a> å®ä½“</h3><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// user.entity.ts</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserEntity</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractEntity</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span>
  lover<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è§†å›¾" tabindex="-1"><a class="header-anchor" href="#è§†å›¾" aria-hidden="true">#</a> è§†å›¾</h3><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// hooks.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> plainToInstance <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;class-transformer&#39;</span>

<span class="token comment">// å‡è®¾å·²è·å–åˆ°åç«¯æ•°æ®</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">&quot;è‡³å°Šå®&quot;</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">27</span><span class="token punctuation">,</span> lover<span class="token operator">:</span> <span class="token string">&quot;ç´«éœä»™å­&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	data<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token function">plainToInstance</span><span class="token punctuation">(</span>UserEntity<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> data
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>ç”¨æˆ·å<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">v-model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user.name<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>å¹´é¾„<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">v-model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user.age<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>å–œæ¬¢<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name"><span class="token namespace">v-model:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user.lover<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user.reset()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>é‡ç½®<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span> <span class="token attr-name">setup</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> useUser <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./hooks&#39;</span>

<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">useUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€ä¹ˆæ ·çœ‹èµ·æ¥ä¸é”™å§ï¼Œå¾ˆç®€æ´ æ¸…æ™°</p><h2 id="é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#é—®é¢˜" aria-hidden="true">#</a> é—®é¢˜</h2><h3 id="weakmap-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#weakmap-æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> WeakMap æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><code>WeakMap</code>è¿™ä¸ªå¤§å®¶åº”è¯¥å¾ˆå°‘è§ï¼Œç¡®å® æˆ‘ä¹Ÿå°‘è§è¿™ä¸ªï¼ŒES6çœ‹äº†ä¸å°‘ï¼Œä½†æ˜¯è¿™ä¸ªç¡®å®æ²¡æ€ä¹ˆç ”ç©¶è¿‡</p><p>å…ˆçœ‹çœ‹MDNæ€ä¹ˆè§£é‡Š</p>`,18)),s("blockquote",null,[s("p",null,[s("a",v,[n[3]||(n[3]=a("WeakMap")),t(e)]),n[7]||(n[7]=a("æ˜¯ä¸€ç§")),n[8]||(n[8]=s("strong",null,"é”®å€¼å¯¹",-1)),n[9]||(n[9]=a("çš„é›†åˆï¼Œå…¶ä¸­çš„é”®å¿…é¡»æ˜¯å¯¹è±¡æˆ–")),s("a",m,[n[4]||(n[4]=a("éå…¨å±€æ³¨å†Œçš„ç¬¦å·")),t(e)]),n[10]||(n[10]=a("ï¼Œä¸”å€¼å¯ä»¥æ˜¯ä»»æ„çš„ ")),s("a",b,[n[5]||(n[5]=a("JavaScript ç±»å‹")),t(e)]),n[11]||(n[11]=a("ï¼Œå¹¶ä¸”ä¸ä¼šåˆ›å»ºå¯¹å®ƒçš„é”®çš„å¼ºå¼•ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªå¯¹è±¡ä½œä¸º ")),n[12]||(n[12]=s("code",null,"WeakMap",-1)),n[13]||(n[13]=a(" çš„é”®å­˜åœ¨ï¼Œä¸ä¼šé˜»æ­¢è¯¥å¯¹è±¡è¢«åƒåœ¾å›æ”¶ã€‚ä¸€æ—¦ä¸€ä¸ªå¯¹è±¡ä½œä¸ºé”®è¢«å›æ”¶ï¼Œé‚£ä¹ˆåœ¨ ")),n[14]||(n[14]=s("code",null,"WeakMap",-1)),n[15]||(n[15]=a(" ä¸­ç›¸åº”çš„å€¼ä¾¿æˆä¸ºäº†è¿›è¡Œåƒåœ¾å›æ”¶çš„å€™é€‰å¯¹è±¡ï¼Œåªè¦å®ƒä»¬æ²¡æœ‰å…¶ä»–çš„å¼•ç”¨å­˜åœ¨ã€‚å”¯ä¸€å¯ä»¥ä½œä¸º ")),n[16]||(n[16]=s("code",null,"WeakMap",-1)),n[17]||(n[17]=a(" çš„é”®çš„åŸå§‹ç±»å‹æ˜¯")),s("a",g,[n[6]||(n[6]=a("éå…¨å±€æ³¨å†Œçš„ç¬¦å·")),t(e)]),n[18]||(n[18]=a("ï¼Œå› ä¸ºéå…¨å±€æ³¨å†Œçš„ç¬¦å·æ˜¯ä¿è¯å”¯ä¸€çš„ï¼Œå¹¶ä¸”ä¸èƒ½è¢«é‡æ–°åˆ›å»ºã€‚"))]),s("p",null,[n[20]||(n[20]=s("code",null,"WeakMap",-1)),n[21]||(n[21]=a(" å…è®¸å°†æ•°æ®ä¸å¯¹è±¡ç›¸å…³è”ï¼Œè€Œä¸é˜»æ­¢é”®å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼Œå³ä½¿å€¼å¼•ç”¨äº†é”®ã€‚ç„¶è€Œï¼Œ")),n[22]||(n[22]=s("code",null,"WeakMap",-1)),n[23]||(n[23]=a(" å¹¶ä¸å…è®¸è§‚å¯Ÿå…¶é”®çš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä¸å…è®¸æšä¸¾ï¼›å¦‚æœ ")),n[24]||(n[24]=s("code",null,"WeakMap",-1)),n[25]||(n[25]=a(" æä¾›äº†ä»»ä½•è·å¾—å…¶é”®çš„åˆ—è¡¨çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™äº›åˆ—è¡¨å°†ä¼šä¾èµ–äºåƒåœ¾å›æ”¶çš„çŠ¶æ€ï¼Œè¿™å¼•å…¥äº†ä¸ç¡®å®šæ€§ã€‚å¦‚æœä½ æƒ³è¦å¯ä»¥è·å–é”®çš„åˆ—è¡¨ï¼Œä½ åº”è¯¥ä½¿ç”¨ ")),s("a",f,[n[19]||(n[19]=s("code",null,"Map",-1)),t(e)]),n[26]||(n[26]=a(" è€Œä¸æ˜¯ ")),n[27]||(n[27]=s("code",null,"WeakMap",-1)),n[28]||(n[28]=a("ã€‚"))])]),n[35]||(n[35]=o('<p>è¯´ç™½äº†WeakMap çš„ key å¦‚æœæ˜¯å¯¹è±¡ï¼Œä¸”è¿™ä¸ªå¯¹è±¡è¢«å›æ”¶å é‚£ä¹ˆ æ‰€å¯¹åº”çš„ value ä¹Ÿå°±è¢« å›æ”¶äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§å»åšæ•°æ®ç¼“å­˜çš„æ“ä½œ å˜¿å˜¿å˜¿ğŸ¤“</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ ref çš„å˜é‡ åœ¨ vue ç»„ä»¶é”€æ¯æ—¶ ä¼šè‡ªåŠ¨çš„ä¹Ÿä¼šå»é”€æ¯å˜é‡é‚£ä¹ˆ</p><p>å½“ è·å–åç«¯æ•°æ® åˆå§‹åŒ– class æ—¶ åˆ™å¯ä»¥ æŠŠåŸå§‹æ•°æ®ç¼“å­˜èµ·æ¥ï¼Œé‡ç½®çš„æ—¶å€™ æ‹¿å‡ºæ¥æ›´æ–°æ‰ï¼Œref é”€æ¯æ—¶ï¼Œåˆ™ è‡ªåŠ¨è§£é™¤äº†å¼•ç”¨ WeakMap åˆ™è‡ªåŠ¨å›æ”¶ value å€¼</p><h3 id="ä¸ºä»€ä¹ˆåœ¨-constructor-é‡Œè¦-settimeout" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆåœ¨-constructor-é‡Œè¦-settimeout" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆåœ¨ constructor é‡Œè¦ setTimeoutï¼Ÿ</h3><p>å…¶å®è¿™æ˜¯è·Ÿ å¾®ä»»åŠ¡/å®ä»»åŠ¡ æœ‰å…³ç³»çš„</p><p>new çš„æ—¶å€™åªæ˜¯ä¼šåˆå§‹åŒ–ä¸€ä¸ªæ™®é€šç±»è€Œå·²ã€‚å¦‚æœæ˜¯åˆå§‹åŒ–æ•°æ®åˆ™ï¼ˆ<strong>æ³¨æ„æ­¤æ—¶æ•°æ®å¹¶æ²¡æœ‰è¢«å¡«å……</strong>ï¼‰ï¼Œæ­¤æ—¶ this æ˜¯ä¸€ä¸ª æœªè¢«å¡«å……æ•°æ®çš„ç©ºå¯¹è±¡ æ‰€ä»¥éœ€è¦ setTimeout æˆ–è€… Promise.then åšå¼‚æ­¥æ“ä½œï¼Œå¦åˆ™<code>self.toJSON()</code>è¿”å›çš„æ˜¯ç©ºå¯¹è±¡</p><h3 id="ä¸ºä»€ä¹ˆåœ¨-reset-æ–¹æ³•å†…-éœ€è¦-toraw-this" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆåœ¨-reset-æ–¹æ³•å†…-éœ€è¦-toraw-this" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆåœ¨ reset æ–¹æ³•å†… éœ€è¦ <code>toRaw(this)</code>ï¼Ÿ</h3><p>å› ä¸ºæ­¤æ—¶ this æ˜¯ä¸€ä¸ªè¢« vue ä»£ç†çš„ å¯¹è±¡ï¼Œæ‰€ä»¥ åŸæ¥çš„ this å†…å­˜åœ°å€ è·Ÿ å½“å‰ this å†…å­˜åœ°å€ä¸ä¸€è‡´ æ‰€ä»¥ <code>valueWeakMap.get(this)</code>è·å–åˆ°çš„ æ˜¯ undefined</p><p>åœ¨ constructor é‡Œ WeakMap å­˜çš„ this æ˜¯ æœªè¢«ä»£ç†çš„åŸç”Ÿå¯¹è±¡ï¼Œå› ä¸ºé‚£ä¸ªæ—¶å€™ plainToInstance è¿˜åœ¨åˆå§‹åŒ– class</p><h2 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h2><figure><img src="https://static-1256180570.cos.ap-nanjing.myqcloud.com/image/è¿™èº«æ€æ ·-1729935995.jpg?imageMogr2/interlace/1/quality/100/thumbnail/300x" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Class ä¼˜é›…æ°¸ä¸è¿‡æ—¶</p>',12))])}const q=c(d,[["render",y],["__file","reset_data.html.vue"]]);export{q as default};
